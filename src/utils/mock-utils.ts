import { LocationObject } from "expo-location";

const MOCK_ROUTE = [
    [9.932451348716654, 53.54841861887715],
    [9.932504726073546, 53.54829646185297],
    [9.93286452899639, 53.54802865483566],
    [9.932872436753684, 53.54792529027023],
    [9.934264201910167, 53.547739703258486],
    [9.934573620150701, 53.547676815374615],
    [9.935229128834692, 53.547650993959365],
    [9.93605847407764, 53.54769187785959],
    [9.936362694202643, 53.54771554986576],
    [9.936732096886487, 53.54772415699293],
    [9.937192039444511, 53.54773706768037],
    [9.937510739799166, 53.54774997836353],
    [9.937891007268234, 53.54776934438124],
    [9.938321977066408, 53.5477628890431],
    [9.938655163801002, 53.54777364793955],
    [9.939332037332434, 53.54779553675479],
    [9.93989700614344, 53.54781490275167],
    [9.940248300852602, 53.54784287584266],
    [9.941045051741128, 53.547909580830776],
    [9.941758505944705, 53.54798919632458],
    [9.942771111062711, 53.548135517166486],
    [9.943162243315783, 53.54820867696483],
    [9.94383948157025, 53.54831196117061],
    [9.944494990255379, 53.54839372765494],
    [9.945319837259717, 53.54851459945792],
    [9.946286803110155, 53.5486437037425],
    [9.947641279619063, 53.548815842176026],
    [9.948177275670162, 53.54885242150314],
    [9.949476055441778, 53.54905391200512],
    [9.949899782049386, 53.5491679526902],
    [9.950758100051047, 53.549299206683344],
    [9.952185001067761, 53.54955310731671],
    [9.95358655831106, 53.549652084874594],
    [9.954046500869111, 53.54963917477136],
    [9.956164142902423, 53.5496811849508],
    [9.957369619555891, 53.54965877659123],
    [9.958709609684831, 53.549527523713266],
    [9.960544202976052, 53.54944485305552],
    [9.962581072473483, 53.549467986263124],
    [9.963971764931529, 53.549620756182264],
    [9.967073148285266, 53.54992846999596],
    [9.969826775221634, 53.55004369637953],
    [9.971179773307739, 53.55005230306679],
    [9.971632472675196, 53.549955478112906],
    [9.97287105814587, 53.549695125471885],
    [9.973261422398707, 53.54963863018392],
    [9.975315815229038, 53.54939359055817],
    [9.976566636794018, 53.54932896876218],
    [9.977450369421206, 53.54927646348045],
    [9.979018758796997, 53.54919139911135],
    [9.979813685215674, 53.549091387348085],
    [9.981442892633993, 53.54875548296607],
    [9.983405763569067, 53.54833389029696],
    [9.984384853354726, 53.54812261388423],
    [9.985400318888452, 53.54787648683805],
    [9.986284258770269, 53.54764048783434],
    [9.987409702521234, 53.5474814837585],
    [9.989631831438572, 53.54717943206603],
    [9.991571423649532, 53.54714809551601],
    [9.993133114327946, 53.54720908393199],
    [9.994291136165288, 53.547272476516696],
    [9.994866688833639, 53.54728554543169]
];

export function mockUserLocation(params: {
    setUserLocation: (location: LocationObject) => void;
    updateInterval?: number;
}) {
    let currentPosition = 0;
    const totalPoints = MOCK_ROUTE.length;

    const updateLocation = () => {
        if (currentPosition < totalPoints) {
            params.setUserLocation({
                coords: {
                    longitude: MOCK_ROUTE[currentPosition][0],
                    latitude: MOCK_ROUTE[currentPosition][1],
                    speed: Math.floor(Math.random() * 90) + 10,
                    heading: 0,
                    accuracy: 5,
                    altitude: 0,
                    altitudeAccuracy: 0,
                },
                timestamp: Date.now(),
            });
            currentPosition++;
        } else {
            currentPosition = 0;
        }
    };

    const intervalId = setInterval(updateLocation, params.updateInterval || 3000);

    return () => clearInterval(intervalId);
}